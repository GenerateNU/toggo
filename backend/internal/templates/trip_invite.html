<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>{{ .PageTitle }}</title>
  <meta name="description" content="{{ .MetaDescription }}" />
  <meta property="og:title" content="{{ .PageTitle }}" />
  <meta property="og:description" content="{{ .MetaDescription }}" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="{{ .CanonicalURL }}" />
  {{ if .MetaImage }}<meta property="og:image" content="{{ .MetaImage }}" />{{ end }}
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="{{ .PageTitle }}" />
  <meta name="twitter:description" content="{{ .MetaDescription }}" />
  {{ if .MetaImage }}<meta name="twitter:image" content="{{ .MetaImage }}" />{{ end }}
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { toggo: '#FF7E00' }
        }
      }
    }
  </script>
  <style>
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUpCenter {
      from { opacity: 0; transform: translateY(40px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes slideUpBottom {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    .fade-in { animation: fadeIn 300ms ease-out both; }

    /* Mobile: bottom sheet */
    .modal-wrapper {
      animation: slideUpBottom 500ms cubic-bezier(0.16, 1, 0.3, 1) 150ms both;
    }
    .modal-container {
      position: fixed; inset: 0; z-index: 50;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding: 0;
    }
    .modal-card {
      width: 100%;
      max-width: 100%;
      border-radius: 1.5rem 1.5rem 0 0;
      max-height: 92vh;
      overflow-y: auto;
    }

    /* Desktop: centered modal */
    @media (min-width: 640px) {
      .modal-wrapper {
        animation: slideUpCenter 500ms cubic-bezier(0.16, 1, 0.3, 1) 150ms both;
      }
      .modal-container {
        align-items: center;
        padding: 1rem;
      }
      .modal-card {
        max-width: 400px;
        border-radius: 1rem;
        max-height: none;
        overflow-y: visible;
      }
    }
  </style>
</head>
<body class="min-h-screen font-sans antialiased bg-gradient-to-b from-white via-slate-50 to-blue-50/40 overflow-hidden">

  <!-- Flight path decorations (background) -->
  <svg class="absolute inset-0 w-full h-full pointer-events-none" preserveAspectRatio="xMidYMid slice" xmlns="http://www.w3.org/2000/svg">
    <path d="M -40,220 Q 200,100 520,180" fill="none" stroke="#d1d5db" stroke-width="1.5" stroke-dasharray="10 8" />
    <g transform="translate(500,182) rotate(-15)">
      <polygon points="0,-6 14,0 0,6 3,0" fill="#c4c8cf" />
    </g>
    <path d="M -20,580 Q 260,480 540,560" fill="none" stroke="#d1d5db" stroke-width="1.5" stroke-dasharray="10 8" />
    <g transform="translate(10,578) rotate(20)">
      <polygon points="0,-6 14,0 0,6 3,0" fill="#c4c8cf" />
    </g>
  </svg>

  <!-- Logo (fixed at top, visible behind overlay) -->
  <div class="fixed top-0 left-0 right-0 z-30 flex items-center justify-center pt-6">
    <img src="/static/toggo_logo.svg" alt="toggo" class="w-40 opacity-40" />
  </div>

  <!-- Modal overlay -->
  <div class="fixed inset-0 z-40 bg-black/40 backdrop-blur-sm fade-in"></div>

  <!-- Modal card -->
  <div class="modal-container">
    <div class="modal-wrapper">
      <article class="modal-card overflow-hidden bg-white shadow-2xl">
        {{ if .Data.ErrorMessage }}
        <div class="p-6">
          <h2 class="text-lg font-bold text-zinc-900 mb-2">Invite unavailable</h2>
          <p class="text-sm leading-relaxed text-zinc-500 mb-5">{{ .Data.ErrorMessage }}</p>
          <a href="/join" class="block w-full rounded-xl bg-toggo px-4 py-3 text-center text-sm font-semibold text-white shadow-lg shadow-orange-200/50 hover:bg-orange-500 active:scale-[0.98] transition">
            Enter a different code
          </a>
        </div>
        {{ else }}
        <div class="p-6">
          <h2 class="text-xl font-bold text-zinc-900 mb-4">{{ .Data.TripName }}</h2>

          <!-- Members -->
          <div class="flex items-center gap-2.5 mb-4">
            <div class="flex shrink-0">
              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-2 border-white bg-toggo text-[0.6875rem] font-semibold text-white">{{ printf "%.1s" .Data.FirstMemberName }}</span>
              {{ if gt .Data.OtherMemberCount 0 }}
              <span class="inline-flex items-center justify-center w-8 h-8 rounded-full border-2 border-white bg-orange-100 text-[0.6875rem] font-semibold text-toggo -ml-2">+{{ .Data.OtherMemberCount }}</span>
              {{ end }}
            </div>
            <span class="text-[0.8125rem] text-zinc-500">
              {{ .Data.FirstMemberName }}{{ if gt .Data.OtherMemberCount 0 }} and {{ .Data.OtherMemberCount }} other{{ if gt .Data.OtherMemberCount 1 }}s{{ end }}{{ end }}
            </span>
          </div>

          <!-- Meta -->
          <div class="mb-4 space-y-1.5">
            <div class="flex items-center gap-2 text-[0.8125rem] text-zinc-600">
              <svg class="w-4 h-4 shrink-0 text-zinc-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
              <span>{{ .Data.LocationName }}</span>
            </div>
            <div class="flex items-center gap-2 text-[0.8125rem] text-zinc-600">
              <svg class="w-4 h-4 shrink-0 text-zinc-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>
              <span>{{ .Data.DateRange }}</span>
            </div>
          </div>

          <!-- Cover image -->
          <div class="h-40 overflow-hidden rounded-xl bg-zinc-100 mb-4">
            {{ if .Data.CoverImageURL }}
            <img src="{{ .Data.CoverImageURL }}" alt="Trip cover" class="h-full w-full object-cover" />
            {{ else }}
            <div class="flex h-full w-full items-center justify-center text-sm text-zinc-400">No cover image</div>
            {{ end }}
          </div>

          <p class="text-sm leading-relaxed text-zinc-500 mb-5">You've been invited to join <span class="font-medium text-zinc-700">{{ .Data.TripName }}</span>.</p>

          <!-- Buttons -->
          <a href="{{ .Data.DeepLink }}" class="block w-full rounded-xl bg-toggo px-4 py-3.5 text-center text-sm font-semibold text-white shadow-lg shadow-orange-200/50 hover:bg-orange-500 active:scale-[0.98] transition">
            Open in Toggo
          </a>
          <a href="#" class="block w-full rounded-xl border border-zinc-200 bg-white px-4 py-3.5 text-center text-sm font-semibold text-zinc-700 hover:bg-zinc-50 active:scale-[0.98] transition mt-2.5">
            Download Toggo
          </a>
          <a href="/join" class="block text-center text-xs text-zinc-400 hover:text-zinc-500 hover:underline mt-4">
            Enter a different code
          </a>
        </div>
        {{ end }}
      </article>
    </div>
  </div>
</body>
</html>
